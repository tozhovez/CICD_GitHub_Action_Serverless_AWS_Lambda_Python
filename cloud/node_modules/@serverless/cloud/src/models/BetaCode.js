'use strict'

const request = require('../utils/request')

class BetaCode {
  constructor({ org }) {
    this.org = org
  }

  async create({ email }) {
    const options = {
      accessKey: this.org.accessKey,
      method: 'POST',
      endpoint: `/orgs/${this.org.orgName}/betacodes`,
      body: { email }
    }

    return await request(options)
  }

  async query({ activated, email, code, orgName }) {
    const options = {
      accessKey: this.org.accessKey,
      method: 'GET',
      endpoint: `/orgs/${this.org.orgName}/betacodes`,
      params: { activated, email, code, orgName }
    }

    return await request(options)
  }

  async activate({ code, orgName }) {
    const options = {
      accessKey: this.org.accessKey,
      method: 'POST',
      endpoint: `/orgs/${orgName}/activate`,
      body: { code }
    }

    return await request(options)
  }
}

module.exports = BetaCode
